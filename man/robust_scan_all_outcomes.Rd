% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/statistical_utilities.R
\name{robust_scan_all_outcomes}
\alias{robust_scan_all_outcomes}
\title{Robust Validation of Causal Scan Results (Bootstrap + Permutation)}
\usage{
robust_scan_all_outcomes(
  df,
  scan_results,
  seed = NULL,
  ntree = 500,
  n_boot = 300,
  n_perm = 30,
  alpha = 0.05,
  n_cores = parallel::detectCores() - 1,
  verbose = TRUE,
  always_predictors = NULL,
  categorical_thr = 35,
  quantitative_thr = 40,
  importance_method = c("fixed", "neg_exp", "net_clust"),
  prob = 0.75
)
}
\arguments{
\item{df}{Data frame with all variables.}

\item{scan_results}{List of results returned by \code{scan_all_outcomes_complete()}.}

\item{seed}{Optional integer random seed.}

\item{ntree}{Integer. Number of trees for Random Forest during re-scans (default \code{500}).}

\item{n_boot}{Integer. Bootstrap repetitions on real data (default \code{300}).}

\item{n_perm}{Integer. Number of permutations (each with embedded bootstrap) (default \code{30}).}

\item{alpha}{Numeric. Significance level for the empirical \eqn{p}-value (default \code{0.05}).}

\item{n_cores}{Integer. Number of parallel cores for \code{mclapply} (default \code{parallel::detectCores() - 1}).}

\item{verbose}{Logical. Print progress (default \code{TRUE}).}

\item{always_predictors}{Optional character vector of predictors to keep available.}

\item{categorical_thr}{Numeric. Threshold for categorical variables in \code{evaluate_importance()} (default \code{35}).}

\item{quantitative_thr}{Numeric. Threshold for quantitative variables in \code{evaluate_importance()} (default \code{40}).}

\item{importance_method}{One of \code{"fixed"}, \code{"neg_exp"}, \code{"net_clust"} for \code{evaluate_importance()}.}

\item{prob}{Numeric. Probability cutoff for neural network inside \code{evaluate_importance()} when \code{importance_method="net_clust"}.}
}
\value{
A named list (one entry per tested relation) with elements:
\itemize{
\item \code{predictors}, \code{outcome};
\item \code{bootstrap_freq}: total bootstrap hits (partial-match counting);
\item \code{max_freq}: theoretical maximum hits (\code{n_boot * length(predictors)});
\item \code{freq_perm}: vector of permutation bootstrap counts (or \code{NA} if skipped);
\item \code{p_empirical}: empirical \eqn{p}-value;
\item \code{significant}: logical flag (\code{p_empirical < alpha}).
}
}
\description{
Validates each relation found by a prior scan (e.g. \code{scan_all_outcomes_complete})
using (1) bootstrap repetitions on real data to count how often the relation (or
a subset with same outcome) reappears, and (2) an empirical permutation test
with embedded bootstrap to compute \eqn{p}-values.
}
\details{
Bootstrap step: resamples rows with replacement (and shuffles columns order),
reruns \code{scan_all_outcomes_complete()} on the subset of variables for the
target relation, and counts partial matches (same outcome and predictors included).
Permutation step: shuffles all variables within the subset and repeats the
bootstrap to build the null distribution of the count; computes \eqn{p}-value.
}
\examples{
\dontrun{
set.seed(42)
val <- robust_scan_all_outcomes(
  df, scan_results,
  ntree = 500, n_boot = 200, n_perm = 50, alpha = 0.05, n_cores = 4
)
}

}
\seealso{
\code{\link{scan_all_outcomes_complete}}, \code{\link{evaluate_importance}}
}
