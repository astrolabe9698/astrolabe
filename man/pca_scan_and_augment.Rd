% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pca_utilities.R
\name{pca_scan_and_augment}
\alias{pca_scan_and_augment}
\title{PCA-Guided Causal Scan and Augmentation}
\usage{
pca_scan_and_augment(
  df,
  ncomp = 5,
  top_k = 5,
  alpha = 0.05,
  n_boot = 30,
  n_perm = 100,
  ntree = 500,
  seed = 101,
  n_cores = parallel::detectCores() - 1,
  which = c("all", "robust", "binary"),
  always_predictors = NULL,
  verbose = TRUE,
  plot = TRUE,
  categorical_thr = 35,
  quantitative_thr = 40,
  fixed_variables = NULL,
  importance_method = c("fixed", "neg_exp", "net_clust")
)
}
\arguments{
\item{df}{Data frame with variables to analyze.}

\item{ncomp}{Integer. Maximum number of PCA components (passed to \code{mixed_pca_topvars}).}

\item{top_k}{Integer. Top variables per component to retain.}

\item{alpha}{Numeric. Significance level for permutation tests (default \code{0.05}).}

\item{n_boot}{Integer. Number of bootstraps (default \code{30}).}

\item{n_perm}{Integer. Number of permutations (default \code{100}).}

\item{ntree}{Integer. Trees for Random Forest (default \code{500}).}

\item{seed}{Optional integer seed.}

\item{n_cores}{Integer. Parallel cores (default \code{parallel::detectCores()-1}).}

\item{which}{One of \code{"all"}, \code{"robust"}, \code{"binary"}; passed to \code{complete_function}.}

\item{always_predictors}{Optional character vector of predictors to always include.}

\item{verbose}{Logical. Verbose output (default \code{TRUE}).}

\item{plot}{Logical. If \code{TRUE}, build a causal graph from the restricted scan.}

\item{categorical_thr, quantitative_thr}{Numeric thresholds for \code{evaluate_importance()}.}

\item{fixed_variables}{Optional character vector of columns to exclude from PCA but re-attach for scanning.}

\item{importance_method}{One of \code{"fixed"}, \code{"neg_exp"}, \code{"net_clust"} for \code{evaluate_importance()}.}
}
\value{
A list with:
\itemize{
\item \code{pca}: result from \code{mixed_pca_topvars};
\item \code{top_variables}: unique variables selected from PCA;
\item \code{scan_topvars}: list returned by \code{complete_function()} on the restricted set;
\item \code{plot}: recorded plot (if \code{plot=TRUE}), else \code{NULL}.
}
}
\description{
Preprocesses variables, runs mixed PCA to find top-contributing variables,
then re-runs the full causal pipeline (\code{complete_function}) restricted
to those variables (optionally re-adding \code{fixed_variables}). Optionally
renders a causal graph from the restricted scan.
}
\examples{
\dontrun{
set.seed(101)
res <- pca_scan_and_augment(
  df,
  ncomp = 5, top_k = 5, which = "all",
  n_boot = 30, n_perm = 100, ntree = 500
)
res$top_variables
}

}
\seealso{
\code{\link{mixed_pca_topvars}}, \code{\link{complete_function}}
}
