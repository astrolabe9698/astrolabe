% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/statistical_utilities.R
\name{cor_forest_matrix_robust_perm}
\alias{cor_forest_matrix_robust_perm}
\title{Robust Pairwise Direction Matrix via Bootstrap + Permutation}
\usage{
cor_forest_matrix_robust_perm(
  df,
  B = 30,
  P = 30,
  seed = NULL,
  ntree = 300,
  n_cores = parallel::detectCores() - 1,
  alpha = 0.05,
  verbose = TRUE,
  always_predictors = NULL,
  categorical_thr = 35,
  quantitative_thr = 40,
  importance_method = c("fixed", "neg_exp", "net_clust"),
  prob = 0.75
)
}
\arguments{
\item{df}{Data frame with all variables.}

\item{B}{Integer. Number of bootstrap repetitions on real data (default \code{30}).}

\item{P}{Integer. Number of permutations (each with embedded bootstrap) (default \code{30}).}

\item{seed}{Optional integer random seed.}

\item{ntree}{Integer. Trees for Random Forest in inner scans (default \code{300}).}

\item{n_cores}{Integer. Parallel cores for \code{mclapply} (default \code{parallel::detectCores() - 1}).}

\item{alpha}{Numeric. Significance level for empirical \eqn{p}-values (default \code{0.05}).}

\item{verbose}{Logical. Print progress (default \code{TRUE}).}

\item{always_predictors}{Optional character vector of predictors to keep available (pairs where both are in this set are skipped).}

\item{categorical_thr, quantitative_thr}{Thresholds for \code{evaluate_importance()}.}

\item{importance_method}{One of \code{"fixed"}, \code{"neg_exp"}, \code{"net_clust"}.}

\item{prob}{Numeric. Probability cutoff for neural network when \code{importance_method="net_clust"}.}
}
\value{
A list of four matrices (dimension = \code{p Ã— p}, row/col names = variable names):
\itemize{
\item \code{real}: binary adjacency (1 if direction selected on real data);
\item \code{freq}: bootstrap hit counts for the selected direction;
\item \code{significant}: binary adjacency after permutation test (\code{p < alpha});
\item \code{pval}: matrix of empirical \eqn{p}-values (rounded).
}
}
\description{
For every unordered variable pair \eqn{(X, Y)}, infers the preferred direction
(\eqn{X \to Y} or \eqn{Y \to X}) on real data, then estimates robustness by
bootstrap frequency and an empirical permutation test. Aggregates results into
four matrices.
}
\details{
For each pair, runs \code{scan_all_outcomes_complete()} on the 2D subset and
keeps only truly binary decisions. Bootstrap counts how often the same direction
reappears; permutations shuffle the target outcome to form a null distribution.
}
\examples{
\dontrun{
mats <- cor_forest_matrix_robust_perm(
  df, B = 50, P = 100, ntree = 300, n_cores = 4, alpha = 0.05
)
image(mats$significant)  # quick look at significant directions
}

}
\seealso{
\code{\link{scan_all_outcomes_complete}}, \code{\link{robust_scan_all_outcomes}}
}
